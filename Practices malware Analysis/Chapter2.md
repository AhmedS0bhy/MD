# Basic Static Analysis

## Introduction
* Antivirus scanning
* online antivirus scanning 
* fingerprint / Hash
* PE File Format 
* unPacking file 

## Antivirus scanning Advantage and disadvantge 
* Signatures-based detection
* heuristics-based detection
* Behavior-based detection
* Machine learning

## Online scanning 
- advantage of online / offline scanning (VirusTotal)

## hashing 
- what is hashing 
- how to use it 
- hashing tools (linux:sha1sum,md5sum,sha256um),(Windows:HashTools,Quickhash,pestudio)

## String Analysis
* what can i get ->  fileName,URL,IP,Registry,DLL,meaning words > can have a fake data 
* tools (strings ,bintext,pestudio,)

## Extracting Hidden Strings 
* Encrypted string (Stack string,Simple XOR)
* Tools (FLOSS)

## PE File format Anaysis

### PE Structure
* DOS MZ header 
* DOS stub
* PE header 
* Section 
* Tools (PE-Bear,CFF-Explorer,)
#### DOS MZ Header 64 bytes

#### DOS stub 

#### PE header
- Signature 
- fileheader
- optionalheader
    - addressOfEntryPoint
    - ImageBase
    - SizeOfImage
- Data Directory
    - Import table
    - Export table
    > note search for coommand dll.  
    > function end with A ASCII, W Wide character , EX Updated 
#### Section
- contains the exeutable code
- stores global data accessed thugt the program
- imnport sections
    - .text -> contains the executable code
    - .data -> stores global data accesed throughout
    - .rdata-> holds read-only data 
    - idata -> Sometimes present and stores the import function information
    - edata -> Sometimes present and stores the export function information
    - pdata -> Present only in 64-bit executables and stores exception-handling information
    - reloc -> Contains information for relocation of library files

##### Browse resource section 
malware can hide some PE or domains, keys and more in the resouece section
- tool `ressource hacker`
## Packed executable 
### Manual packed detection tools
- PEID
    - normal mode -> looking for segnature
    - Deep mode -> scan the .text section 
    - hardcore mode -> scan the entire PE 
- Exeinfo
- detect it easy 
    - entropy
#### auto unpacked tool
#### analysis without unpacking 

## PE Header Summary
The PE header contains useful information for the malware analyst, and we
will continue to examine it in subsequent chapters. Table 1-7 reviews the key
information that can be obtained from a PE header.

|Field| Information revealed|
|-----|---------------------|
|Imports| Functions from other libraries that are used by the malware|
|Exports| Functions in the malware that are meant to be called by other programs|
or libraries|
|Time Date Stamp Time| when the program was compiled|
|Sections| Names of sections in the file and their sizes on disk and in memory|
|Subsystem| Indicates whether the program is a command-line or GUI application|
|Resources| Strings, icons, menus, and other information included in the file|

